# Configuração do SNMP para o Asterisk
Este passo é necessário para que o Gerenciador obtenha os dados do Dashboard.

1. Certifique-se de que o arquivo /etc/apt/sources.list contenha os repositórios `main`, `contrib` e `nonfree`, conforme abaixo:

    ```bash
    deb http://ftp.br.debian.org/debian/ stretch main contrib non-free
    deb-src http://ftp.br.debian.org/debian/ stretch main contrib non-free
    
    deb http://security.debian.org/debian-security stretch/updates main contrib non-free
    deb-src http://security.debian.org/debian-security stretch/updates main contrib non-free
    
    # stretch-updates, previously known as 'volatile'
    deb http://ftp.br.debian.org/debian/ stretch-updates main contrib non-free
    deb-src http://ftp.br.debian.org/debian/ stretch-updates main contrib non-free
    ```

1. Instale as dependências necessárias:

    ```bash
    apt-get update
    apt-get install snmp snmpd libsnmp-dev snmp-mibs-downloader uuid-dev libjansson-dev
    ```

1. Recompile o Asterisk com suporte ao módulo res_snmp.so:

    ```bash   
    ./configure && make menuselect && make && make install
    ```

    Certifique-se que a opção res_snmp` esteja marcada dentro de Resource Modules.

1. Edite o arquivo /etc/snmp/snmpd.conf e certifique-se que as seguintes linhas encontrem-se próximas ao final do arquivo:

    ```bash
    master  agentx
    agentXperms 0660 0550 root root
    ```
    
    ```bash
    ###############################################################################
    #
    # EXAMPLE.conf:
    #   An example configuration file for configuring the ucd-snmp snmpd agent.
    #
    ###############################################################################
    #
    # This file is intended to only be an example.  If, however, you want
    # to use it, it should be placed in /etc/snmp/snmpd.conf.
    # When the snmpd agent starts up, this is where it will look for it.
    #
    # You might be interested in generating your own snmpd.conf file using
    # the "snmpconf" program (perl script) instead.  It's a nice menu
    # based interface to writing well commented configuration files.  Try it!
    #
    # Note: This file is automatically generated from EXAMPLE.conf.def.
    # Do NOT read the EXAMPLE.conf.def file! Instead, after you have run
    # configure & make, and then make sure you read the EXAMPLE.conf file
    # instead, as it will tailor itself to your configuration.
    
    # All lines beginning with a '#' are comments and are intended for you
    # to read.  All other lines are configuration commands for the agent.
    
    #
    # PLEASE: read the snmpd.conf(5) manual page as well!
    #
    
    
    ###############################################################################
    # Access Control
    ###############################################################################
    
    # YOU SHOULD CHANGE THE "COMMUNITY" TOKEN BELOW TO A NEW KEYWORD ONLY
    # KNOWN AT YOUR SITE.  YOU *MUST* CHANGE THE NETWORK TOKEN BELOW TO
    # SOMETHING REFLECTING YOUR LOCAL NETWORK ADDRESS SPACE.
    
    # By far, the most common question I get about the agent is "why won't
    # it work?", when really it should be "how do I configure the agent to
    # allow me to access it?"
    #
    # By default, the agent responds to the "public" community for read
    # only access, if run out of the box without any configuration file in
    # place.  The following examples show you other ways of configuring
    # the agent so that you can change the community names, and give
    # yourself write access as well.
    #
    # The following lines change the access permissions of the agent so
    # that the COMMUNITY string provides read-only access to your entire
    # NETWORK (EG: 10.10.10.0/24), and read/write access to only the
    # localhost (127.0.0.1, not its real ipaddress).
    #
    # For more information, read the FAQ as well as the snmpd.conf(5)
    # manual page.
    
    ####
    # First, map the community name (COMMUNITY) into a security name
    # (local and mynetwork, depending on where the request is coming
    # from):
    
    #       sec.name  source          community
    #com2sec paranoid  default         public
    com2sec readonly   default         public
    #com2sec readwrite default         private
    
    includeAlldisks 10%
    
    
    ####
    # Second, map the security names into group names:
    
    #               sec.model  sec.name
    group MyROSystem v1        paranoid
    group MyROSystem v2c       paranoid
    group MyROSystem usm       paranoid
    group MyROGroup v1         readonly
    group MyROGroup v2c        readonly
    group MyROGroup usm        readonly
    group MyRWGroup v1         readwrite
    group MyRWGroup v2c        readwrite
    group MyRWGroup usm        readwrite
    
    ####
    # Third, create a view for us to let the groups have rights to:
    
    #           incl/excl subtree                          mask
    view all    included  .1                               80
    view system included  .iso.org.dod.internet.mgmt.mib-2.system
    
    ####
    # Finally, grant the 2 groups access to the 1 view with different
    # write permissions:
    
    #                context sec.model sec.level match  read   write  notif
    access MyROSystem ""     any       noauth    exact  system none   none
    access MyROGroup ""      any       noauth    exact  all    none   none
    access MyRWGroup ""      any       noauth    exact  all    all    none
    
    # -----------------------------------------------------------------------------
    
    
    ###############################################################################
    # System contact information
    #
    
    # It is also possible to set the sysContact and sysLocation system
    # variables through the snmpd.conf file.  **PLEASE NOTE** that setting
    # the value of these objects here makes these objects READ-ONLY
    # (regardless of any access control settings).  Any attempt to set the
    # value of an object whose value is given here will fail with an error
    # status of notWritable.
    
    syslocation Unknown (configure /etc/snmp/snmpd.local.conf)
    syscontact Root <root@localhost> (configure /etc/snmp/snmpd.local.conf)
    
    # Example output of snmpwalk:
    #   % snmpwalk -v 1 -c public localhost system
    #   system.sysDescr.0 = "SunOS name sun4c"
    #   system.sysObjectID.0 = OID: enterprises.ucdavis.ucdSnmpAgent.sunos4
    #   system.sysUpTime.0 = Timeticks: (595637548) 68 days, 22:32:55
    #   system.sysContact.0 = "Me <me@somewhere.org>"
    #   system.sysName.0 = "name"
    #   system.sysLocation.0 = "Right here, right now."
    #   system.sysServices.0 = 72
    
    
    # -----------------------------------------------------------------------------
    
    
    ###############################################################################
    # Process checks.
    #
    #  The following are examples of how to use the agent to check for
    #  processes running on the host.  The syntax looks something like:
    #
    #  proc NAME [MAX=0] [MIN=0]
    #
    #  NAME:  the name of the process to check for.  It must match
    #         exactly (ie, http will not find httpd processes).
    #  MAX:   the maximum number allowed to be running.  Defaults to 0.
    #  MIN:   the minimum number to be running.  Defaults to 0.
    
    #
    #  Examples:
    #
    
    #  Make sure mountd is running
    #proc mountd
    
    #  Make sure there are no more than 4 ntalkds running, but 0 is ok too.
    #proc ntalkd 4
    
    #  Make sure at least one sendmail, but less than or equal to 10 are running.
    #proc sendmail 10 1
    
    #  A snmpwalk of the prTable would look something like this:
    #
    # % snmpwalk -v 1 -c public localhost .1.3.6.1.4.1.2021.2
    # enterprises.ucdavis.procTable.prEntry.prIndex.1 = 1
    # enterprises.ucdavis.procTable.prEntry.prIndex.2 = 2
    # enterprises.ucdavis.procTable.prEntry.prIndex.3 = 3
    # enterprises.ucdavis.procTable.prEntry.prNames.1 = "mountd"
    # enterprises.ucdavis.procTable.prEntry.prNames.2 = "ntalkd"
    # enterprises.ucdavis.procTable.prEntry.prNames.3 = "sendmail"
    # enterprises.ucdavis.procTable.prEntry.prMin.1 = 0
    # enterprises.ucdavis.procTable.prEntry.prMin.2 = 0
    # enterprises.ucdavis.procTable.prEntry.prMin.3 = 1
    # enterprises.ucdavis.procTable.prEntry.prMax.1 = 0
    # enterprises.ucdavis.procTable.prEntry.prMax.2 = 4
    # enterprises.ucdavis.procTable.prEntry.prMax.3 = 10
    # enterprises.ucdavis.procTable.prEntry.prCount.1 = 0
    # enterprises.ucdavis.procTable.prEntry.prCount.2 = 0
    # enterprises.ucdavis.procTable.prEntry.prCount.3 = 1
    # enterprises.ucdavis.procTable.prEntry.prErrorFlag.1 = 1
    # enterprises.ucdavis.procTable.prEntry.prErrorFlag.2 = 0
    # enterprises.ucdavis.procTable.prEntry.prErrorFlag.3 = 0
    # enterprises.ucdavis.procTable.prEntry.prErrMessage.1 = "No mountd process running."
    # enterprises.ucdavis.procTable.prEntry.prErrMessage.2 = ""
    # enterprises.ucdavis.procTable.prEntry.prErrMessage.3 = ""
    # enterprises.ucdavis.procTable.prEntry.prErrFix.1 = 0
    # enterprises.ucdavis.procTable.prEntry.prErrFix.2 = 0
    # enterprises.ucdavis.procTable.prEntry.prErrFix.3 = 0
    #
    #  Note that the errorFlag for mountd is set to 1 because one is not
    #  running (in this case an rpc.mountd is, but thats not good enough),
    #  and the ErrMessage tells you what's wrong.  The configuration
    #  imposed in the snmpd.conf file is also shown.
    #
    #  Special Case:  When the min and max numbers are both 0, it assumes
    #  you want a max of infinity and a min of 1.
    #
    
    
    # -----------------------------------------------------------------------------
    
    
    ###############################################################################
    # Executables/scripts
    #
    
    #
    #  You can also have programs run by the agent that return a single
    #  line of output and an exit code.  Here are two examples.
    #
    #  exec NAME PROGRAM [ARGS ...]
    #
    #  NAME:     A generic name.
    #  PROGRAM:  The program to run.  Include the path!
    #  ARGS:     optional arguments to be passed to the program
    
    # a simple hello world
    #exec echotest /bin/echo hello world
    
    # Run a shell script containing:
    #
    # #!/bin/sh
    # echo hello world
    # echo hi there
    # exit 35
    #
    # Note:  this has been specifically commented out to prevent
    # accidental security holes due to someone else on your system writing
    # a /tmp/shtest before you do.  Uncomment to use it.
    #
    #exec shelltest /bin/sh /tmp/shtest
    
    # Then,
    # % snmpwalk -v 1 -c public localhost .1.3.6.1.4.1.2021.8
    # enterprises.ucdavis.extTable.extEntry.extIndex.1 = 1
    # enterprises.ucdavis.extTable.extEntry.extIndex.2 = 2
    # enterprises.ucdavis.extTable.extEntry.extNames.1 = "echotest"
    # enterprises.ucdavis.extTable.extEntry.extNames.2 = "shelltest"
    # enterprises.ucdavis.extTable.extEntry.extCommand.1 = "/bin/echo hello world"
    # enterprises.ucdavis.extTable.extEntry.extCommand.2 = "/bin/sh /tmp/shtest"
    # enterprises.ucdavis.extTable.extEntry.extResult.1 = 0
    # enterprises.ucdavis.extTable.extEntry.extResult.2 = 35
    # enterprises.ucdavis.extTable.extEntry.extOutput.1 = "hello world."
    # enterprises.ucdavis.extTable.extEntry.extOutput.2 = "hello world."
    # enterprises.ucdavis.extTable.extEntry.extErrFix.1 = 0
    # enterprises.ucdavis.extTable.extEntry.extErrFix.2 = 0
    
    # Note that the second line of the /tmp/shtest shell script is cut
    # off.  Also note that the exit status of 35 was returned.
    
    # -----------------------------------------------------------------------------
    
    
    ###############################################################################
    # disk checks
    #
    
    # The agent can check the amount of available disk space, and make
    # sure it is above a set limit.
    
    # disk PATH [MIN=DEFDISKMINIMUMSPACE]
    #
    # PATH:  mount path to the disk in question.
    # MIN:   Disks with space below this value will have the Mib's errorFlag set.
    #        Default value = DEFDISKMINIMUMSPACE.
    
    # Check the / partition and make sure it contains at least 10 megs.
    
    #disk / 10000
    
    # % snmpwalk -v 1 -c public localhost .1.3.6.1.4.1.2021.9
    # enterprises.ucdavis.diskTable.dskEntry.diskIndex.1 = 0
    # enterprises.ucdavis.diskTable.dskEntry.diskPath.1 = "/" Hex: 2F
    # enterprises.ucdavis.diskTable.dskEntry.diskDevice.1 = "/dev/dsk/c201d6s0"
    # enterprises.ucdavis.diskTable.dskEntry.diskMinimum.1 = 10000
    # enterprises.ucdavis.diskTable.dskEntry.diskTotal.1 = 837130
    # enterprises.ucdavis.diskTable.dskEntry.diskAvail.1 = 316325
    # enterprises.ucdavis.diskTable.dskEntry.diskUsed.1 = 437092
    # enterprises.ucdavis.diskTable.dskEntry.diskPercent.1 = 58
    # enterprises.ucdavis.diskTable.dskEntry.diskErrorFlag.1 = 0
    # enterprises.ucdavis.diskTable.dskEntry.diskErrorMsg.1 = ""
    
    # -----------------------------------------------------------------------------
    
    
    ###############################################################################
    # load average checks
    #
    
    # load [1MAX=DEFMAXLOADAVE] [5MAX=DEFMAXLOADAVE] [15MAX=DEFMAXLOADAVE]
    #
    # 1MAX:   If the 1 minute load average is above this limit at query
    #         time, the errorFlag will be set.
    # 5MAX:   Similar, but for 5 min average.
    # 15MAX:  Similar, but for 15 min average.
    
    # Check for loads:
    #load 12 14 14
    
    # % snmpwalk -v 1 -c public localhost .1.3.6.1.4.1.2021.10
    # enterprises.ucdavis.loadTable.laEntry.loadaveIndex.1 = 1
    # enterprises.ucdavis.loadTable.laEntry.loadaveIndex.2 = 2
    # enterprises.ucdavis.loadTable.laEntry.loadaveIndex.3 = 3
    # enterprises.ucdavis.loadTable.laEntry.loadaveNames.1 = "Load-1"
    # enterprises.ucdavis.loadTable.laEntry.loadaveNames.2 = "Load-5"
    # enterprises.ucdavis.loadTable.laEntry.loadaveNames.3 = "Load-15"
    # enterprises.ucdavis.loadTable.laEntry.loadaveLoad.1 = "0.49" Hex: 30 2E 34 39
    # enterprises.ucdavis.loadTable.laEntry.loadaveLoad.2 = "0.31" Hex: 30 2E 33 31
    # enterprises.ucdavis.loadTable.laEntry.loadaveLoad.3 = "0.26" Hex: 30 2E 32 36
    # enterprises.ucdavis.loadTable.laEntry.loadaveConfig.1 = "12.00"
    # enterprises.ucdavis.loadTable.laEntry.loadaveConfig.2 = "14.00"
    # enterprises.ucdavis.loadTable.laEntry.loadaveConfig.3 = "14.00"
    # enterprises.ucdavis.loadTable.laEntry.loadaveErrorFlag.1 = 0
    # enterprises.ucdavis.loadTable.laEntry.loadaveErrorFlag.2 = 0
    # enterprises.ucdavis.loadTable.laEntry.loadaveErrorFlag.3 = 0
    # enterprises.ucdavis.loadTable.laEntry.loadaveErrMessage.1 = ""
    # enterprises.ucdavis.loadTable.laEntry.loadaveErrMessage.2 = ""
    # enterprises.ucdavis.loadTable.laEntry.loadaveErrMessage.3 = ""
    
    # -----------------------------------------------------------------------------
    
    
    ###############################################################################
    # Extensible sections.
    #
    
    # This alleviates the multiple line output problem found in the
    # previous executable mib by placing each mib in its own mib table:
    
    # Run a shell script containing:
    #
    # #!/bin/sh
    # echo hello world
    # echo hi there
    # exit 35
    #
    # Note:  this has been specifically commented out to prevent
    # accidental security holes due to someone else on your system writing
    # a /tmp/shtest before you do.  Uncomment to use it.
    #
    # exec .1.3.6.1.4.1.2021.50 shelltest /bin/sh /tmp/shtest
    
    # % snmpwalk -v 1 -c public localhost .1.3.6.1.4.1.2021.50
    # enterprises.ucdavis.50.1.1 = 1
    # enterprises.ucdavis.50.2.1 = "shelltest"
    # enterprises.ucdavis.50.3.1 = "/bin/sh /tmp/shtest"
    # enterprises.ucdavis.50.100.1 = 35
    # enterprises.ucdavis.50.101.1 = "hello world."
    # enterprises.ucdavis.50.101.2 = "hi there."
    # enterprises.ucdavis.50.102.1 = 0
    
    # Now the Output has grown to two lines, and we can see the 'hi
    # there.' output as the second line from our shell script.
    #
    # Note that you must alter the mib.txt file to be correct if you want
    # the .50.* outputs above to change to reasonable text descriptions.
    
    # Other ideas:
    #
    # exec .1.3.6.1.4.1.2021.51 ps /bin/ps
    # exec .1.3.6.1.4.1.2021.52 top /usr/local/bin/top
    # exec .1.3.6.1.4.1.2021.53 mailq /usr/bin/mailq
    
    # -----------------------------------------------------------------------------
    
    
    ###############################################################################
    # Pass through control.
    #
    
    # Usage:
    #   pass MIBOID EXEC-COMMAND
    #
    # This will pass total control of the mib underneath the MIBOID
    # portion of the mib to the EXEC-COMMAND.
    #
    # Note:  You'll have to change the path of the passtest script to your
    # source directory or install it in the given location.
    #
    # Example:  (see the script for details)
    #           (commented out here since it requires that you place the
    #           script in the right location. (its not installed by default))
    
    # pass .1.3.6.1.4.1.2021.255 /bin/sh /usr/local/passtest
    
    # % snmpwalk -v 1 -c public localhost .1.3.6.1.4.1.2021.255
    # enterprises.ucdavis.255.1 = "life the universe and everything"
    # enterprises.ucdavis.255.2.1 = 42
    # enterprises.ucdavis.255.2.2 = OID: 42.42.42
    # enterprises.ucdavis.255.3 = Timeticks: (363136200) 42 days, 0:42:42
    # enterprises.ucdavis.255.4 = IpAddress: 127.0.0.1
    # enterprises.ucdavis.255.5 = 42
    # enterprises.ucdavis.255.6 = Gauge: 42
    #
    # % snmpget -v 1 -c public localhost .1.3.6.1.4.1.2021.255.5
    # enterprises.ucdavis.255.5 = 42
    #
    # % snmpset -v 1 -c public localhost .1.3.6.1.4.1.2021.255.1 s "New string"
    # enterprises.ucdavis.255.1 = "New string"
    #
    
    # For specific usage information, see the man/snmpd.conf.5 manual page
    # as well as the local/passtest script used in the above example.
    
    ###############################################################################
    # Subagent control
    #
    
    # The agent can support subagents using a number of extension mechanisms.
    # From the 4.2.1 release, AgentX support is being compiled in by default.
    # To use this mechanism, simply uncomment the following directive.
    #
     master  agentx
     agentXperms 0660 0550 root root
    
    #
    #   Please see the file README.agentx for more details.
    #
    
    
    ###############################################################################
    # Further Information
    #
    #  See the snmpd.conf manual page, and the output of "snmpd -H".
    #  MUCH more can be done with the snmpd.conf than is shown as an
    #  example here.
    ```

1. Reinicie o serviço SNMP:

    ```bash
    /etc/init.d/snmpd restart
    ```

1. Altere o arquivo `/etc/asterisk/res_snmp.conf` para ativar o módulo:

    ```bash
    sed -i.old \
    	-e 's/;subagent = yes/subagent = yes/g' \
    	-e 's/;enabled = yes/enabled = yes/g' \
    	/etc/asterisk/res_snmp.conf
    ```

1. Carregue o módulo res_snmp.so dentro do Asterisk:

    ```bash
    pabx*CLI> module load res_snmp.so
    Loaded res_snmp.so
    [Mar 16 09:49:59]   == Parsing '/etc/asterisk/res_snmp.conf': Found
    [Mar 16 09:49:59]  Loading [Sub]Agent Module
    [Mar 16 09:49:59]  Loaded res_snmp.so => (SNMP [Sub]Agent for Asterisk)
    [Mar 16 09:49:59]   == Starting SubAgent
    ```

1. Crie o diretório para armazenar os MIBs:

    ```bash
    mkdir -p /usr/share/snmp/mibs
    ```
    
1. Crie o arquivo `/usr/share/snmp/mibs/digium-mib.txt` com o seguinte conteúdo:

    ```bash   
    DIGIUM-MIB DEFINITIONS ::= BEGIN
    
    IMPORTS
    	enterprises, MODULE-IDENTITY
    		FROM SNMPv2-SMI;
    
    digium MODULE-IDENTITY
    	LAST-UPDATED	"200806202000Z"
    	ORGANIZATION	"Digium, Inc."
    	CONTACT-INFO
    		"Mark Spencer
    		Email: markster@digium.com"
    	DESCRIPTION
    		"The Digium private-enterprise MIB"
    	REVISION	"200806202000Z"
    	DESCRIPTION
    		"Corrected imports and missing revision for last update.
    		 Addresses bug 12905. - jeffg@opennms.org"
    	REVISION	"200602041900Z"
    	DESCRIPTION
    		"Initial revision."
    	::= { enterprises 22736 }
    
    END
    ```

1. Crie o arquivo `/usr/share/snmp/mibs/asterisk-mib.txt` com o seguinte conteúdo:

    ```bash
    ASTERISK-MIB DEFINITIONS ::= BEGIN
    
    IMPORTS
    	OBJECT-TYPE, MODULE-IDENTITY, Integer32, Counter32, TimeTicks,
    	Unsigned32, Gauge32
    		FROM SNMPv2-SMI
    
    	TEXTUAL-CONVENTION, DisplayString, TruthValue
    		FROM SNMPv2-TC
    
    	digium
    		FROM DIGIUM-MIB;
    
    asterisk MODULE-IDENTITY
    	LAST-UPDATED	"200806202025Z"
    	ORGANIZATION	"Digium, Inc."
    	CONTACT-INFO
    		"Mark A. Spencer
    		Postal: Digium, Inc.
    		        445 Jan Davis Drive
    		        Huntsville, AL 35806
    		        USA
    		   Tel: +1 256 428 6000
    		 Email: markster@digium.com
    
    		Thorsten Lockert
    		Postal: Voop AS
    		        Boehmergaten 42
    			NO-5057 Bergen
    			Norway
    		   Tel: +47 5598 7200
    		 Email: tholo@voop.no"
    	DESCRIPTION
    		"Asterisk is an Open Source PBX.  This MIB defined
    		objects for managing Asterisk instances."
    	REVISION	"200806202025Z"
    	DESCRIPTION
    		"smilint police --
    		 Add missing imports; fix initial capitalization
    		 of enumeration elements; add missing range
    		 restrictions for Integer32 indices, correct
    		 spelling of astChanCidANI in its definition.
    		 Addresses bug 12905. - jeffg@opennms.org"
    	REVISION	"200708211450Z"
    	DESCRIPTION
    		"Add total and current call counter statistics."
    	REVISION	"200603061840Z"
    	DESCRIPTION
    		"Change audio codec identification from 3kAudio to
    		Audio3k to conform better with specification.
    
    		Expand on contact information."
    	REVISION	"200602041900Z"
    	DESCRIPTION
    		"Initial published revision."
    	::= { digium 1 }
    
    asteriskVersion		OBJECT IDENTIFIER ::= { asterisk 1 }
    asteriskConfiguration	OBJECT IDENTIFIER ::= { asterisk 2 }
    asteriskModules		OBJECT IDENTIFIER ::= { asterisk 3 }
    asteriskIndications	OBJECT IDENTIFIER ::= { asterisk 4 }
    asteriskChannels	OBJECT IDENTIFIER ::= { asterisk 5 }
    
    -- asteriskVersion
    
    astVersionString OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Text version string of the version of Asterisk that
    		the SNMP Agent was compiled to run against."
    	::= { asteriskVersion 1 }
    
    astVersionTag OBJECT-TYPE
    	SYNTAX		Unsigned32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"SubVersion revision of the version of Asterisk that
    		the SNMP Agent was compiled to run against -- this is
    		typically 0 for release-versions of Asterisk."
    	::= { asteriskVersion 2 }
    
    -- asteriskConfiguration
    
    astConfigUpTime OBJECT-TYPE
    	SYNTAX		TimeTicks
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Time ticks since Asterisk was started."
    	::= { asteriskConfiguration 1 }
    
    astConfigReloadTime OBJECT-TYPE
    	SYNTAX		TimeTicks
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Time ticks since Asterisk was last reloaded."
    	::= { asteriskConfiguration 2 }
    
    astConfigPid OBJECT-TYPE
    	SYNTAX		Integer32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"The process id of the running Asterisk process."
    	::= { asteriskConfiguration 3 }
    
    astConfigSocket OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"The control socket for giving Asterisk commands."
    	::= { asteriskConfiguration 4 }
    
    astConfigCallsActive OBJECT-TYPE
    	SYNTAX		Gauge32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"The number of calls currently active on the Asterisk PBX."
    	::= { asteriskConfiguration 5 }
    
    astConfigCallsProcessed OBJECT-TYPE
    	SYNTAX		Counter32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"The total number of calls processed through the Asterisk PBX since last
    		restart."
    	::= { asteriskConfiguration 6 }
    
    -- asteriskModules
    
    astNumModules OBJECT-TYPE
    	SYNTAX		Integer32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Number of modules currently loaded into Asterisk."
    	::= { asteriskModules 1 }
    
    -- asteriskIndications
    
    astNumIndications OBJECT-TYPE
    	SYNTAX		Integer32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Number of indications currently defined in Asterisk."
    	::= { asteriskIndications 1 }
    
    astCurrentIndication OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Default indication zone to use."
    	::= { asteriskIndications 2 }
    
    astIndicationsTable OBJECT-TYPE
    	SYNTAX		SEQUENCE OF AstIndicationsEntry
    	MAX-ACCESS	not-accessible
    	STATUS		current
    	DESCRIPTION
    		"Table with all the indication zones currently know to
    		the running Asterisk instance."
    	::= { asteriskIndications 3 }
    
    astIndicationsEntry OBJECT-TYPE
    	SYNTAX		AstIndicationsEntry
    	MAX-ACCESS	not-accessible
    	STATUS		current
    	DESCRIPTION
    		"Information about a single indication zone."
    	INDEX		{ astIndIndex }
    	::= { astIndicationsTable 1 }
    
    AstIndicationsEntry ::= SEQUENCE {
    	astIndIndex		Integer32,
    	astIndCountry		DisplayString,
    	astIndAlias		DisplayString,
    	astIndDescription	DisplayString
    }
    
    astIndIndex OBJECT-TYPE
    	SYNTAX		Integer32 (1 .. 2147483647)
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Numerical index into the table of indication zones."
    	::= { astIndicationsEntry 1 }
    
    astIndCountry OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Country for which the indication zone is valid,
    		typically this is the ISO 2-letter code of the country."
    	::= { astIndicationsEntry 2 }
    
    astIndAlias OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		""
    	::= { astIndicationsEntry 3 }
    
    astIndDescription OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Description of the indication zone, usually the full
    		name of the country it is valid for."
    	::= { astIndicationsEntry 4 }
    
    -- asteriskChannels
    
    astNumChannels OBJECT-TYPE
    	SYNTAX		Gauge32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Current number of active channels."
    	::= { asteriskChannels 1 }
    
    astChanTable OBJECT-TYPE
    	SYNTAX		SEQUENCE OF AstChanEntry
    	MAX-ACCESS	not-accessible
    	STATUS		current
    	DESCRIPTION
    		"Table with details of the currently active channels
    		in the Asterisk instance."
    	::= { asteriskChannels 2 }
    
    astChanEntry OBJECT-TYPE
    	SYNTAX		AstChanEntry
    	MAX-ACCESS	not-accessible
    	STATUS		current
    	DESCRIPTION
    		"Details of a single channel."
    	INDEX		{ astChanIndex }
    	::= { astChanTable 1 }
    
    AstChanEntry ::= SEQUENCE {
    	astChanIndex		Integer32,
    	astChanName		DisplayString,
    	astChanLanguage		DisplayString,
    	astChanType		DisplayString,
    	astChanMusicClass	DisplayString,
    	astChanBridge		DisplayString,
    	astChanMasq		DisplayString,
    	astChanMasqr		DisplayString,
    	astChanWhenHangup	TimeTicks,
    	astChanApp		DisplayString,
    	astChanData		DisplayString,
    	astChanContext		DisplayString,
    	astChanMacroContext	DisplayString,
    	astChanMacroExten	DisplayString,
    	astChanMacroPri		Integer32,
    	astChanExten		DisplayString,
    	astChanPri		Integer32,
    	astChanAccountCode	DisplayString,
    	astChanForwardTo	DisplayString,
    	astChanUniqueId		DisplayString,
    	astChanCallGroup	Unsigned32,
    	astChanPickupGroup	Unsigned32,
    	astChanState		INTEGER,
    	astChanMuted		TruthValue,
    	astChanRings		Integer32,
    	astChanCidDNID		DisplayString,
    	astChanCidNum		DisplayString,
    	astChanCidName		DisplayString,
    	astChanCidANI		DisplayString,
    	astChanCidRDNIS		DisplayString,
    	astChanCidPresentation	DisplayString,
    	astChanCidANI2		Integer32,
    	astChanCidTON		Integer32,
    	astChanCidTNS		Integer32,
    	astChanAMAFlags		INTEGER,
    	astChanADSI		INTEGER,
    	astChanToneZone		DisplayString,
    	astChanHangupCause	INTEGER,
    	astChanVariables	DisplayString,
    	astChanFlags		BITS,
    	astChanTransferCap	INTEGER
    }
    
    astChanIndex OBJECT-TYPE
    	SYNTAX		Integer32 (1 .. 2147483647)
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Index into the channel table."
    	::= { astChanEntry 1 }
    
    astChanName OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Name of the current channel."
    	::= { astChanEntry 2 }
    
    astChanLanguage OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Which language the current channel is configured to
    		use -- used mainly for prompts."
    	::= { astChanEntry 3 }
    
    astChanType OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Underlying technology for the current channel."
    	::= { astChanEntry 4 }
    
    astChanMusicClass OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Music class to be used for Music on Hold for this
    		channel."
    	::= { astChanEntry 5 }
    
    astChanBridge OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Which channel this channel is currently bridged (in a
    		conversation) with."
    	::= { astChanEntry 6 }
    
    astChanMasq OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Channel masquerading for us."
    	::= { astChanEntry 7 }
    
    astChanMasqr OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Channel we are masquerading for."
    	::= { astChanEntry 8 }
    
    astChanWhenHangup OBJECT-TYPE
    	SYNTAX		TimeTicks
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"How long until this channel will be hung up."
    	::= { astChanEntry 9 }
    
    astChanApp OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Current application for the channel."
    	::= { astChanEntry 10 }
    
    astChanData OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Arguments passed to the current application."
    	::= { astChanEntry 11 }
    
    astChanContext OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Current extension context."
    	::= { astChanEntry 12 }
    
    astChanMacroContext OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Current macro context."
    	::= { astChanEntry 13 }
    
    astChanMacroExten OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Current macro extension."
    	::= { astChanEntry 14 }
    
    astChanMacroPri OBJECT-TYPE
    	SYNTAX		Integer32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Current macro priority."
    	::= { astChanEntry 15 }
    
    astChanExten OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Current extension."
    	::= { astChanEntry 16 }
    
    astChanPri OBJECT-TYPE
    	SYNTAX		Integer32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Current priority."
    	::= { astChanEntry 17 }
    
    astChanAccountCode OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Account Code for billing."
    	::= { astChanEntry 18 }
    
    astChanForwardTo OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Where to forward to if asked to dial on this
    		interface."
    	::= { astChanEntry 19 }
    
    astChanUniqueId OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Unique Channel Identifier."
    	::= { astChanEntry 20 }
    
    astChanCallGroup OBJECT-TYPE
    	SYNTAX		Unsigned32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Call Group."
    	::= { astChanEntry 21 }
    
    astChanPickupGroup OBJECT-TYPE
    	SYNTAX		Unsigned32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Pickup Group."
    	::= { astChanEntry 22 }
    
    astChanState OBJECT-TYPE
    	SYNTAX		INTEGER {
    		stateDown(0),
    		stateReserved(1),
    		stateOffHook(2),
    		stateDialing(3),
    		stateRing(4),
    		stateRinging(5),
    		stateUp(6),
    		stateBusy(7),
    		stateDialingOffHook(8),
    		statePreRing(9)
    	}
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Channel state."
    	::= { astChanEntry 23 }
    
    astChanMuted OBJECT-TYPE
    	SYNTAX		TruthValue
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Transmission of voice data has been muted."
    	::= { astChanEntry 24 }
    
    astChanRings OBJECT-TYPE
    	SYNTAX		Integer32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Number of rings so far."
    	::= { astChanEntry 25 }
    
    astChanCidDNID OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Dialled Number ID."
    	::= { astChanEntry 26 }
    
    astChanCidNum OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Caller Number."
    	::= { astChanEntry 27 }
    
    astChanCidName OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Caller Name."
    	::= { astChanEntry 28 }
    
    astChanCidANI OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"ANI"
    	::= { astChanEntry 29 }
    
    astChanCidRDNIS OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Redirected Dialled Number Service."
    	::= { astChanEntry 30 }
    
    astChanCidPresentation OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Number Presentation/Screening."
    	::= { astChanEntry 31 }
    
    astChanCidANI2 OBJECT-TYPE
    	SYNTAX		Integer32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"ANI 2 (info digit)."
    	::= { astChanEntry 32 }
    
    astChanCidTON OBJECT-TYPE
    	SYNTAX		Integer32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Type of Number."
    	::= { astChanEntry 33 }
    
    astChanCidTNS OBJECT-TYPE
    	SYNTAX		Integer32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Transit Network Select."
    	::= { astChanEntry 34 }
    
    astChanAMAFlags OBJECT-TYPE
    	SYNTAX		INTEGER {
    		default(0),
    		omit(1),
    		billing(2),
    		documentation(3)
    	}
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"AMA Flags."
    	::= { astChanEntry 35 }
    
    astChanADSI OBJECT-TYPE
    	SYNTAX		INTEGER {
    		unknown(0),
    		available(1),
    		unavailable(2),
    		offHookOnly(3)
    	}
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Whether or not ADSI is detected on CPE."
    	::= { astChanEntry 36 }
    
    astChanToneZone OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Indication zone to use for channel."
    	::= { astChanEntry 37 }
    
    astChanHangupCause OBJECT-TYPE
    	SYNTAX		INTEGER {
    		notDefined(0),
    		unregistered(3),
    		normal(16),
    		busy(17),
    		noAnswer(19),
    		congestion(34),
    		failure(38),
    		noSuchDriver(66)
    	}
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Why is the channel hung up."
    	::= { astChanEntry 38 }
    
    astChanVariables OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Channel Variables defined for this channel."
    	::= { astChanEntry 39 }
    
    astChanFlags OBJECT-TYPE
    	SYNTAX		BITS {
    		wantsJitter(0),
    		deferDTMF(1),
    		writeInterrupt(2),
    		blocking(3),
    		zombie(4),
    		exception(5),
    		musicOnHold(6),
    		spying(7),
    		nativeBridge(8),
    		autoIncrementingLoop(9)
    	}
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Flags set on this channel."
    	::= { astChanEntry 40 }
    
    astChanTransferCap OBJECT-TYPE
    	SYNTAX		INTEGER {
    		speech(0),
    		digital(8),
    		restrictedDigital(9),
    		audio3k(16),
    		digitalWithTones(17),
    		video(24)
    	}
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Transfer Capabilities for this channel."
    	::= { astChanEntry 41 }
    
    astNumChanTypes OBJECT-TYPE
    	SYNTAX		Integer32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Number of channel types (technologies) supported."
    	::= { asteriskChannels 3 }
    
    astChanTypeTable OBJECT-TYPE
    	SYNTAX		SEQUENCE OF AstChanTypeEntry
    	MAX-ACCESS	not-accessible
    	STATUS		current
    	DESCRIPTION
    		"Table with details of the supported channel types."
    	::= { asteriskChannels 4 }
    
    astChanTypeEntry OBJECT-TYPE
    	SYNTAX		AstChanTypeEntry
    	MAX-ACCESS	not-accessible
    	STATUS		current
    	DESCRIPTION
    		"Information about a technology we support, including
    		how many channels are currently using this technology."
    	INDEX		{ astChanTypeIndex }
    	::= { astChanTypeTable 1 }
    
    AstChanTypeEntry ::= SEQUENCE {
    	astChanTypeIndex	Integer32,
    	astChanTypeName		DisplayString,
    	astChanTypeDesc		DisplayString,
    	astChanTypeDeviceState	Integer32,
    	astChanTypeIndications	Integer32,
    	astChanTypeTransfer	Integer32,
    	astChanTypeChannels	Gauge32
    }
    
    astChanTypeIndex OBJECT-TYPE
    	SYNTAX		Integer32 (1 .. 2147483647)
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Index into the table of channel types."
    	::= { astChanTypeEntry 1 }
    
    astChanTypeName OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Unique name of the technology we are describing."
    	::= { astChanTypeEntry 2 }
    
    astChanTypeDesc OBJECT-TYPE
    	SYNTAX		DisplayString
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Description of the channel type (technology)."
    	::= { astChanTypeEntry 3 }
    
    astChanTypeDeviceState OBJECT-TYPE
    	SYNTAX		TruthValue
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Whether the current technology can hold device states."
    	::= { astChanTypeEntry 4 }
    
    astChanTypeIndications OBJECT-TYPE
    	SYNTAX		TruthValue
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Whether the current technology supports progress indication."
    	::= { astChanTypeEntry 5 }
    
    astChanTypeTransfer OBJECT-TYPE
    	SYNTAX		TruthValue
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Whether the current technology supports transfers, where
    		Asterisk can get out from inbetween two bridged channels."
    	::= { astChanTypeEntry 6 }
    
    astChanTypeChannels OBJECT-TYPE
    	SYNTAX		Gauge32
    	MAX-ACCESS	read-only
    	STATUS		current
    	DESCRIPTION
    		"Number of active channels using the current technology."
    	::= { astChanTypeEntry 7 }
    
    astChanScalars OBJECT IDENTIFIER ::= { asteriskChannels 5 }
    
    astNumChanBridge OBJECT-TYPE
           SYNTAX          Gauge32
           MAX-ACCESS      read-only
           STATUS          current
           DESCRIPTION
                   "Number of channels currently in a bridged state."
           ::= { astChanScalars 1 }
    
    END
    ```

1. Para testar, utilize o seguinte comando:

    ```bash    
    snmpwalk -v2c -c public localhost ASTERISK-MIB::astVersionString
    ```

    A resposta deve ser algo similar a:

    ```bash
    ASTERISK-MIB::astVersionString.0 = STRING: 16.4.0
    ```